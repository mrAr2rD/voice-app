<% content_for :page_title, "Клонировать голос" %>

<div class="max-w-2xl mx-auto animate-fade-in">
  <div class="rounded-2xl p-8" style="background: var(--color-abyss); border: 1px solid var(--color-graphite);">
    <%= form_with model: @cloned_voice, data: { controller: "file-upload" }, class: "space-y-6" do |f| %>
      <% if @cloned_voice.errors.any? %>
        <div class="rounded-xl p-4" style="background: rgba(255, 55, 95, 0.1); border: 1px solid rgba(255, 55, 95, 0.2);">
          <ul class="text-sm space-y-1" style="color: var(--color-coral);">
            <% @cloned_voice.errors.full_messages.each do |message| %>
              <li class="flex items-center">
                <svg class="w-4 h-4 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <%= message %>
              </li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- Name -->
      <div>
        <%= f.label :name, class: "block text-sm font-medium mb-2", style: "color: var(--color-cloud);" do %>
          Название голоса
        <% end %>
        <%= f.text_field :name, required: true, maxlength: 100,
            placeholder: "Например: Мой голос, Иван Петров...",
            class: "w-full px-4 py-3 rounded-xl transition-all duration-200 focus:outline-none focus:ring-2",
            style: "background: var(--color-obsidian); border: 1px solid var(--color-graphite); color: var(--color-snow); --tw-ring-color: var(--color-neon-purple);" %>
      </div>

      <!-- Description -->
      <div>
        <%= f.label :description, class: "block text-sm font-medium mb-2", style: "color: var(--color-cloud);" do %>
          Описание <span style="color: var(--color-mist);">(опционально)</span>
        <% end %>
        <%= f.text_area :description, rows: 3, maxlength: 500,
            placeholder: "Опишите особенности голоса...",
            class: "w-full px-4 py-3 rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 resize-none",
            style: "background: var(--color-obsidian); border: 1px solid var(--color-graphite); color: var(--color-snow); --tw-ring-color: var(--color-neon-purple);" %>
      </div>

      <!-- Audio Samples -->
      <div>
        <label class="block text-sm font-medium mb-2" style="color: var(--color-cloud);">
          Аудио образцы
        </label>
        <p class="text-sm mb-3" style="color: var(--color-mist);">
          Загрузите 1-5 аудио файлов (MP3, WAV, M4A). Оптимальная длина: 10-60 секунд каждый.
        </p>

        <div class="relative rounded-xl p-6 text-center cursor-pointer transition-all duration-200 hover:border-opacity-100"
             style="background: var(--color-obsidian); border: 2px dashed var(--color-graphite);"
             data-file-upload-target="dropzone"
             data-action="dragover->file-upload#dragover dragenter->file-upload#dragenter dragleave->file-upload#dragleave drop->file-upload#drop click->file-upload#click">
          <svg class="w-12 h-12 mx-auto mb-4" style="color: var(--color-mist);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
          </svg>
          <p style="color: var(--color-cloud);">Перетащите файлы или нажмите для выбора</p>
          <p class="text-sm mt-1" style="color: var(--color-mist);">MP3, WAV, M4A до 25 MB каждый</p>
          <%= f.file_field :audio_samples, multiple: true, accept: "audio/*",
              class: "absolute inset-0 w-full h-full opacity-0 cursor-pointer",
              data: { file_upload_target: "input", action: "change->file-upload#handleFiles" } %>
        </div>

        <div data-file-upload-target="fileList" class="mt-4 space-y-2"></div>
      </div>

      <!-- Labels -->
      <div>
        <%= f.label :labels, class: "block text-sm font-medium mb-2", style: "color: var(--color-cloud);" do %>
          Метки <span style="color: var(--color-mist);">(опционально)</span>
        <% end %>
        <%= f.text_field :labels, maxlength: 200,
            placeholder: "мужской, молодой, энергичный (через запятую)",
            class: "w-full px-4 py-3 rounded-xl transition-all duration-200 focus:outline-none focus:ring-2",
            style: "background: var(--color-obsidian); border: 1px solid var(--color-graphite); color: var(--color-snow); --tw-ring-color: var(--color-neon-purple);" %>
        <p class="mt-1 text-xs" style="color: var(--color-mist);">
          Метки помогут найти нужный голос
        </p>
      </div>

      <!-- Submit -->
      <%= f.submit "Клонировать голос",
          class: "w-full py-4 rounded-xl font-semibold text-lg transition-all duration-300 hover:scale-[1.02] cursor-pointer",
          style: "background: linear-gradient(135deg, var(--color-neon-purple) 0%, var(--color-neon-pink) 100%); color: white; box-shadow: 0 10px 40px rgba(94, 92, 230, 0.3);" %>
    <% end %>
  </div>

  <!-- Tips -->
  <div class="mt-6 rounded-xl p-5" style="background: rgba(48, 209, 88, 0.1); border: 1px solid rgba(48, 209, 88, 0.2);">
    <h4 class="font-medium mb-3 flex items-center" style="color: var(--color-neon-green);">
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
      </svg>
      Советы для лучшего результата
    </h4>
    <ul class="text-sm space-y-2" style="color: var(--color-cloud);">
      <li class="flex items-start">
        <span class="mr-2">1.</span>
        Используйте чистые записи без фонового шума и музыки
      </li>
      <li class="flex items-start">
        <span class="mr-2">2.</span>
        Записывайте разнообразную речь: вопросы, утверждения, эмоции
      </li>
      <li class="flex items-start">
        <span class="mr-2">3.</span>
        Минимум 30 секунд суммарного аудио для качественного клона
      </li>
      <li class="flex items-start">
        <span class="mr-2">4.</span>
        Говорите естественно, избегайте монотонности
      </li>
    </ul>
  </div>
</div>
